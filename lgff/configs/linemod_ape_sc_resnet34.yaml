# lgff/configs/linemod_ape_sc.yaml

# ===================== Dataset =====================
dataset_name: "bop-single"                # 按 SingleObjectDataset 里原来的分支来
dataset_root: "/home/xyh/PycharmProjects/FFB6D-high-pytorch/lgff/data/linemod_ape_crop128"

obj_id: 1                                 # LINEMOD ape 在 BOP 里是 1
num_classes: 1
num_points: 1024                          # 每帧采样的点数量（和 dataloader 对应）
val_split: "test"                         # 我们刚才裁剪的是 test 子集

# 裁剪后图片已是 128×128，这里保持一致（只是个 sanity 配置）
resize_h: 128
resize_w: 128

depth_scale: 1000.0                       # BOP LM 默认 1000，和裁剪脚本一致

batch_size: 32
num_workers: 8

# ===================== Training Hyper-params =====================
epochs: 80                                # 先跑 80 轮，后面看曲线再改
lr: 1.0e-4
weight_decay: 1.0e-5
use_amp: true
log_interval: 20                          # 每 20 个 iteration 打一条日志

# 学习率调度器：plateau / cosine / step / none
scheduler: "plateau"

# plateau 参数
lr_patience: 20
lr_factor: 0.5
lr_min: 1.0e-6

# step / cosine 时会用到
lr_step_size: 30

# 梯度裁剪
max_grad_norm: 2.0

# ===================== Model / Backbone =====================
backbone_name: "resnet34"

backbone_output_stride: 8                 # 高分辨率特征图
backbone_pretrained: true
backbone_freeze_bn: true                  # 小 batch 建议冻结 BN
backbone_return_intermediate: false       # 暂时不用低层特征
backbone_low_level_index: 2


# 增加特征维度 (Capacity)
rgb_feat_dim: 256
geo_feat_dim: 256


# ===================== PointNet Branch =====================
point_input_dim: 3                        # (x, y, z)
point_hidden_dims: [64, 128, 256]
point_norm: "bn"
point_use_se: true
point_dropout: 0.0

# ===================== Head =====================
head_hidden_dim: 256
head_feat_dim: 128

head_dropout: 0.0

# ===================== Loss & Symmetry =====================
w_rate: 0.05                             # 你之前用的默认
sym_class_ids: []                         # ape 非对称

# ===================== Logging / Output =====================
log_dir: "/home/xyh/PycharmProjects/FFB6D-high-pytorch/output/linemod_ape_sc_resnet"
work_dir: "/home/xyh/PycharmProjects/FFB6D-high-pytorch/output/linemod_ape_sc_resnet"
